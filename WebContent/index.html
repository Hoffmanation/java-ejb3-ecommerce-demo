<!DOCTYPE html>
<html>
<head>
    <title>MyStuff</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />


	<link href="images/favicon.png" rel="icon" type="image/png" />
    <link href="https://fonts.googleapis.com/css?family=Varela" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/custom.css" rel="stylesheet" />
    <link href="css/nouislider.min.css" rel="stylesheet">



    <script type="text/javascript" src="js/angular.min.js"></script>
    <script type="text/javascript" src="js/respond.min.js"></script>
    
    <style type="text/css">
    
 .grayBc{
     background: none repeat scroll 0 0 black;
    /* position: fixed; */
    display: block;
    opacity: 0.5;
    z-index: 1000001;
    //: ;
    or, higher left: 0;
    top: 0;
    height: 100%;
    width: 100%;
 
 
 }   
.lds-grid {
    /* display: flex; */
    position: absolute;
    /* width: 419px; */
    margin: 0px auto;
    z-index: 1000;
    height: 3px;
    margin-top: 150px;
    margin-left: 610px;
}
.lds-grid div {position: absolute;width: 50px;height: 46px;border-radius: 50%;background: #e0452b;animation: lds-grid 1.2s linear infinite;}
.lds-grid div:nth-child(1) {
    top: -5px;
    left: 5px;
    animation-delay: 0s;
}
.lds-grid div:nth-child(2) {
    top: -5px;
    left: 68px;
    animation-delay: -0.4s;
}
.lds-grid div:nth-child(3) {
    top: -5px;
    left: 131px;
    animation-delay: -0.8s;
}
.lds-grid div:nth-child(4) {top: 53px;left: 5px;animation-delay: -0.4s;}
.lds-grid div:nth-child(5) {
    top: 53px;
    left: 68px;
    animation-delay: -0.8s;
}
.lds-grid div:nth-child(6) {top: 53px;left: 131px;animation-delay: -1.2s;}
.lds-grid div:nth-child(7) {
    top: 109px;
    left: 5px;
    animation-delay: -0.8s;
}
.lds-grid div:nth-child(8) {
    top: 109px;
    left: 68px;
    animation-delay: -1.2s;
}
.lds-grid div:nth-child(9) {
    top: 109px;
    left: 131px;
    animation-delay: -1.6s;
}
@keyframes lds-grid {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

    
    
    
    </style>

</head>
<body>


<div id="main" data-ng-app="MyStuffCustomerApp" data-ng-controller="CustomerController" ng-init="handleCustomerSession('refresh')">




    <!------------------------ Side nav ------------------------->
    <div id="mySidenav" class="sidenav">
        <img src="images/logo_dark.png" alt="" />
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="my-account.html" ng-show="myAccountShow()"><img src="images/account_icon_side.png" alt="" />My Account</a>
        <a href="javascript:void(0)" data-ng-click="getCart()"><img src="images/cart_icon_side.png" alt="" />My Cart</a>
        <a href="javascript:void(0)"><img src="images/info_icon_side.png" alt="" />About</a>
        <a href="https://www.oren-hoffman.com/" target="_blank"><img src="images/contact_icon_side.png" alt="" />Contact</a>
    </div>
    
    <!-- About Modal -->
    <div id="about_modal" class="modal">
        <div class="modal_content">
            <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
            <h2 class="uppearcase spaced">About MyStuff</h2>		
            <!-- <hr align="left" style="width:60px; background-color:#e4e4e4; margin-top: 35px; margin-bottom: 30px;" /> -->
            <p style="margin-bottom: 0px; margin-top:20px;">Create an account to track your orders, make a wishlist and more :)</p>
        </div>
    </div>
    
    <!-- Contact Modal -->
    <div id="contact_modal" class="modal">
        <div class="modal_content">
            <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
            <h2 class="uppearcase spaced">Contact us</h2>		  
            <p style="margin-bottom: 0px; margin-top:20px;">Email: orenhoffman1777@gmail.com | LinkedIn: </p>
            <hr align="left" style="width:60px; background-color:#e4e4e4; margin-top: 35px; margin-bottom: 30px;" />
            <form>
            	<input type="text" maxlength="50" placeholder="Name" />
            	<input type="text" maxlength="50" placeholder="Email" />
            	<textarea type="text" rows="3" placeholder="Message"></textarea>
            	<button type="submit" id="send_msg_btn">Create Account</button>
            </form>
        </div>
    </div>
    
    <!-- User account Modal -->
    <div id="account_modal" class="modal">
        <div class="modal_content">
            <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
            <h2 class="uppearcase spaced">My Account</h2>
            <table class="cart_table" >

                <tr class="cart_titles">
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Total</th>
                    <th></th>
                </tr>

                <tr class="cart_row" data-ng-repeat="product in PrintCart">
                    <td class="td_prod">
                        <div>
                            <img src="{{product.imagePath}}" alt="" /></img> 
                        </div>
                        <div>
                            <span>{{product.name}}</span>
                            <span>{{product.type}}</span>

                        </div>
                    </td>
                    <td class="td_qty">
                        <div class="prod_quantity">
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                </span>
                                <input type="number" name="quant[1]" class="form-control input-number" value="1" min="1" max="99">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </td>
                    <td class="td_total">{{product.price}}$</td>
                    <td class="td_remove"><img src="images/remove_icon.png" alt="" data-ng-click="removeFromCart(product.productId)"/></td>
                </tr>

            </table>
            <div class="cart_sum">
                <span>Total</span>
                <span>{{cartSum}}$</span>
                <span>{{conformation}}</span>
                <span>{{errormessage}}</span>
                <button id="checkout_btn" data-ng-click="checkOut()">Proceed to Checkout</button>
            </div>
            
        </div>
    </div>

    <!------------------------ HEADER ------------------------->
    <header id="header" class="jumbotron" style="margin-bottom:0px;">
    

        <div class="login_btns">
            <a id="login" class="uppearcase" ng-show="loginBtnShow()" ng-click="cleanUpVariables()">Login</a>
            <a id="signup" class="uppearcase" ng-show="signupBtnShow()" ng-click="cleanUpVariables()">Sign up</a>
       		<a id="logout" class="uppearcase" ng-click="logout()" ng-show="logoutBtnShow()">Logout</a>
        </div>
        

        <div id="banner">
            <img src="images/logo_dark.png" alt="" class="img-responsive" />
            
            <!------- SEARCH ------->
            <div class="search"> 
                 <input type="text" maxlength="50"  placeholder="Search something to buy..." ng-model="query"/>
           		 <a id="main_search" class="fa fa-search" href="#products_container"></a>					
            </div>
            
     
            
        </div>

        <a id="browse_stuff" class="uppearcase" href="#products_container">
            Browse stuff
        </a>

        <!-- Error Modal -->
        <div id="error_modal" class="modal">
            <div class="modal_content">
                <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
                <h2 class="uppearcase spaced">Mystuff Message</h2>
                <div id="error_msg">{{globalErrorMessage}}</div>
            </div>
        </div>
        
         <!-- Admin Modal -->
        <div id="admin_modal" class="modal">
            <div class="modal_content">
                <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
                <h2 class="uppearcase spaced">Admin Login</h2>
                 <input type="text" placeholder="Username"  data-ng-model="email" style="margin-top:35px;" />
                <input type="password" placeholder="Password" data-ng-model="password"/>
                <div id="admin_login_msg">{{adminLoginMessage}}</div>
                 <button id="login_btn" data-admin="admin" data-ng-click="login($event)" onclick="show_login_msg()">Login</button>
            </div>
        </div>

        <!-- Login Modal -->
        <div id="login_modal" class="modal">
            <div class="modal_content">
                <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
                <h2 class="uppearcase spaced">Login</h2>
                <input type="text" placeholder="Email Address"  data-ng-model="email" style="margin-top:35px;" />
                <input type="password" placeholder="Password" data-ng-model="password"/>

                <div id="remember_me">
                    <input type="checkbox" id="c0" /><label for="c0"><span></span>Remember me</label>
                    <a href="#">Forgot my password</a>                
                    <a href="#" id="admin" style="margin-right: 92px;">Admin login</a>
                </div>
				<div id="login_msg">{{loginMessage}}</div>
				
                <button id="login_btn" data-ng-click="login()" onclick="show_login_msg()">Login</button>
                
                <button id="fblogin_btn">
                    <i class="fa fa-facebook-square" aria-hidden="true"></i>
                    <span>Login with Facebook</span>
                </button>
						
                <hr align="left" style="width:60px; background-color:#e4e4e4; margin-top: 35px; margin-bottom: 30px;" />

                <h2 class="uppearcase spaced">New User?</h2>
                <p style="margin-bottom: 0px; margin-top:20px;">Create an account to track your orders, make a wishlist and more :)</p>
                <button id="create_acc_btn" onclick="goto_signup()">Create Account</button>
            </div>
        </div>





        <!-- Signup Modal -->
        <div id="signup_modal" class="modal">
            <div class="modal_content">
                <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
                <h2 class="uppearcase spaced">Create an Account</h2>

                <p>Create an account to track your orders, make a wishlist and more :)</p>

                <input type="text" placeholder="First Name" data-ng-model="name" style="width:49%; margin-right:5px" />
                <input type="text" placeholder="Last Name" data-ng-model="f_name" style="width:49%;" />
                <input type="password" placeholder="Password" data-ng-model="password"/>
                <input type="password" placeholder="Repeat Password" data-ng-model="secondPassword"/>
                <input type="text" placeholder="Email Address" data-ng-model="email" />
                
				<div id="signup_msg">{{signupMessage}}</div>
				
                <button id="create_acc_btn" data-ng-click="signUp()" onclick="show_signup_msg()" >Create Account</button>	
            </div>
        </div>
    </header>



    <!----------------------- NAV BAR ------------------------->
    <div id="navbar" class="row">
        <div class="nav_left col-md-6 col-sm-5 col-xs-8">
            <span onclick="openNav()" class="fa fa-bars"></span>
            <img class="nav_logo" src="images/logo_light.png" alt="" />
        </div>

        <div class="nav_right col-md-6 col-sm-7 col-xs-4" >
            <div class="nav_search hidden-xs">
                <input type="text" maxlength="50" data-ng-model="searchPro" placeholder="Search something to buy..." />
                <span id="nav_search" class="fa fa-search" ></span>
            </div>
            <div class="nav_right_icons">
                <div id="cart" class="notification-container" data-ng-click="getCart()" >
                    <img src="images/cart_icon.png" alt="" style="width:16px;" />
                    <span class="notification-counter">{{cartSize}}</span>
                </div>
                <a ng-click="handleCustomerSession('myAccount')"><img src="images/account_icon.png" alt="" style="width:16px; cursor: pointer;" /></a>
            </div>
        </div>
    </div>

    <!-- Nav Bar > Cart Modal -->
    <div id="cart_modal" class="modal">
        <div class="modal_content" style="max-width:960px">
            <img class="close" src="images/close_icon.png" onclick="close_modal()"  />
            <h2 class="uppearcase spaced">Your Cart</h2>
			<div class="table_wrapper">
            <table class="cart_table" >

                <tr class="cart_titles">
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th></th>
                </tr>

                <tr class="cart_row" data-ng-repeat="product in PrintCart">
                    <td class="td_prod">
                        <div>
                            <img src="{{product.imagePath}}" alt="" />
                        </div>
                        <div>
                            <span>{{product.name}}</span>
                            <span>{{product.type}}</span>

                        </div>
                    </td>
                    <td class="td_qty">
                        <div class="prod_quantity">
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                </span>
                                <input type="number" name="quant[1]" class="form-control input-number" value="1" min="1" max="99">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </td>
                    <td class="td_total">{{product.price}}$</td>
                    <td class="td_remove"><img src="images/remove_icon.png" alt="" data-ng-click="removeFromCart(product.productId)"/></td>
                </tr>

            </table>
            <h2 id="empty_msg" >{{cartMessage}}</h2>
            <h2 id="empty_msg" ng-show="myvar != orderId"><a href="my-account.html?orderId={{orderId}}">View Your Order</a></h2>
			</div>
            <div class="cart_sum">
                <span>Total</span>
                <span>{{cartSum}}$</span>
                <span>{{errormessage}}</span>
                <button id="checkout_btn" data-ng-click="checkOut()">Proceed to Checkout</button>
            </div>
            
        </div>
    </div>

    <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
    <!---------------------- Main section ------------------------>
    <div id="products_container" class="row">
        <!---------------------- Options bar ------------------------>
        <div id="options_bar" class="col-lg-12 ">
            <div class="row">
                <div class="col-md-2 col-sm-4 col-xs-3">
                    <span class="items_found"></span>
                    <span id="items_found_a">items</span>
                </div>
                <div class="col-md-9 col-sm-6 col-xs-6">
                    Sort by <a data-ng-click="getAllProductByPriceChe()" class="price_sort"><span>Price</span><i id="sort_by_price" class="fa fa-arrow-up" aria-hidden="true"></i></a>
                </div>
                <div class="col-md-1 col-sm-2 col-xs-3">
                    <img src="images/gridview_on.png" alt="" class="grid" /><img src="images/listview_off.png" alt="" class="list" />
                </div>
            </div>
        </div>
        
        
        <!------------------------ Filters -------------------------->
        <div id="filters" class="col-md-2 col-sm-4 col-xs-12">
            <div id="cat_filter"  >
                <h2>Category</h2><a href="#" id="toggle"><img id="tog_img" src="images/toggle_off.png" /></a>
                <ul class="toggle">
                    <li><input type="checkbox" id="c1" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Appliances'"><label for="c1"><span ></span>Appliances</label></li>
                    <li><input type="checkbox" id="c2" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Clothing'"><label for="c2"><span></span>Clothing</label></li>
                    <li><input type="checkbox" id="c3" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Decoration'"><label for="c3"><span></span>Decoration</label></li>
                    <li><input type="checkbox" id="c4" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Furniture'"><label for="c4"><span></span>Furniture</label></li>
                    <li><input type="checkbox" id="c5" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Music'"><label for="c5"><span></span>Music</label></li>
                    <li><input type="checkbox" id="c6" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Sport'"><label for="c6"><span></span>Sport</label></li>
                    <li><input type="checkbox" id="c7" name="cc" data-ng-click="getAllProductsByType()" data-ng-model="Type"  ng-true-value="'Technology'"><label for="c7"><span></span>Technology</label></li>
                </ul>
            </div>
            <hr />
 
            <div id="price_range">
                <h2 ng-click="print()">Price</h2><a href="#" id="toggle2"><img id="tog_img" src="images/toggle_off.png" /></a>
                <div id="price_slider" class="toggle2" ng-model="max" ng-click="searchProductByPrice()" >
					<div id="value-lower"  style="display:none;"></div>
					<div id="value-upper"  style="display:none;"></div>
                </div>
            </div>
            <hr />
        </div>



        <!--------------------- Products ----------------------->
        <!-- Product Modal --> 
        <div id="prod_modal" class="modal" data-ng-init="getAllProductById(product.productId)" >
            <div class="prod_modal_container" data-ng-repeat="product in PrintAllProductsById">

                <div class="prod_img">
                    <img src="{{product.imagePath}}" alt="" />
                    <i class="enlarge_prod_img fa fa-expand" onmouseenter="maximize()" onmouseleave="minimize()" aria-hidden="true"></i>
                </div>

                <div class="prod_modal_content">
                    <img class="close" src="images/close_icon.png" onclick="close_modal()" />

                    <!--<button class="con_shopping_btn">< &nbsp; Continue Shopping</button>-->
                    <span class="prod_cat">{{product.type}}</span>
                    <h2 class="spaced">{{product.name}}</h2>
                    <span class="prod_code uppearcase">Sku: {{product.productId}}</span>

                    <div class="prod_actions" data-ng-controller="CustomerController">
                        <span class="prod_price">{{product.price}}$</span>
                        <div class="prod_quantity">
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                </span>
                                <input type="number" name="quant[1]" class="form-control input-number" value="1" min="1" max="99" >
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <button class="add_to_cart_btn" data-ng-click="addToCart(product.productId)">+ Add to cart</button>
                        <i class="fa fa-heart-o wishlist_icon wishlist_icon_1" aria-hidden="true" title="Add to wishlist"></i>
                    </div>

                    <ul class="tabs_nav">
                        <li><a href="javascript:void(0)" class="tablink" onclick="openTab(event, 'prod_desc');">Description</a></li>
                        <li><a href="javascript:void(0)" class="tablink" onclick="openTab(event, 'prod_ship');">Shipping</a></li>
                        <li><a href="javascript:void(0)" class="tablink" onclick="openTab(event, 'prod_return');">Return</a></li>
                        <li class="slider"></li>
                    </ul>

                    <div id="prod_desc" class="prod_tabs">
                        <p>
                          {{product.description}}
                        </p>
                    </div>
                    <div id="prod_ship" class="prod_tabs">
                        <p>
                            {{product.description}}{{product.description}}
                        </p>
                    </div>
                    <div id="prod_return" class="prod_tabs">
                        <p>
                            {{product.description}}
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        

        <!-- Products -->
      
        <div id="prods" class="col-md-10 col-sm-8 col-xs-12" >
           <div class="lds-grid"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
           
            <ul class="row grid" id="PrintAllProducs" data-ng-init="getAllProducts()">
                <li id="{{product.productId}}" class="col-lg-2 col-md-3 col-sm-6 col-xs-12 prod" data-ng-repeat="product in PrintAllProducts | filter:query | orderBy:sortField:reverse" >
                 
                    <div class="img_container">
                        <img src="{{product.imagePath}}" alt="" />
                    </div>
                    <div class="prod_details" data-ng-click="getProductById(product.productId)">
                        <div class="prod_titlecat">
                            <span class="prod_title">{{product.name}}</span>
                            <span class="prod_cat">{{product.type}}</span>
                        </div>
                        <div class="prod_pricebtns">
                            <span class="prod_price">{{product.price}}$</span>
                            <i class="fa fa-heart-o wishlist_icon wishlist_icon_1" aria-hidden="true" title="Add to wishlist"></i>
                            <button class="add_to_cart_btn" data-ng-click="addToCart(product.productId)">+ Add to cart</button>
                        </div>
                    </div>

                    <div class="prod_overlay" data-ng-click="getProductById(product.productId)">
                        <span class="prod_overlay_title">{{product.name}}</span>
                        <span class="prod_overlay_cat">{{product.type}}</span>
                        <div class="prod_overlay_btns">
                            <button class="add_to_cart_btn" data-ng-click="addToCart(product.productId)">+ Add to cart</button>
                            <i class="fa fa-heart-o wishlist_icon wishlist_icon_1" aria-hidden="true" title="Add to wishlist"></i> 
                        </div>
                        <span class="prod_overlay_price">{{product.price}}$</span>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    </div>
  

    <!------------- Javascript --------------->
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/nouislider.min.js"></script>


    <script type="text/javascript" defer>
    var min_price;
    var max_price;
    var enlarge = document.getElementsByClassName("enlarge_prod_img");
    //var prod_counter = 0;

    if ($(window).width() < 960) {
            	  $("button.add_to_cart_btn").html("+").width("5px");
            	  $("span.prod_cat").hide();
            	  $(".cart_row .td_prod span:nth-child(2)").hide();
            	  $("i.enlarge_prod_img").hide();
            	  $("#prod_modal .close").prependTo(".prod_modal_container");
            	}
    
        $(document).ready(function () {
            $(this).scrollTop(0);
			
            if ($(window).width() < 960) {
            	  $("span#items_found_a").html(" ");
            	  
            	}

            
            $("#prod_modal").on("click", ".tabs_nav li", function(e) {
              // what tab was pressed
          	  var whatTab = $(this).index();
          	  // How far the slider needs to go
          	  var howFar = 95 * whatTab;
          	  $(".slider").css({left: + howFar + "px"});          	
         	 });
            
            
			// Counter++ for cart icon
/* 			$('#prods').on("click", ".add_to_cart_btn", function () {
                var $counter = $('.notification-counter');
                var val = parseInt($counter.text());
                val++;
                return $counter.css({ opacity: 0 }).text(val).css({ top: '-10px' }).animate({ top: '-1px', opacity: 1 }, 500);
            });
			// Counter-- for cart icon
			$(".cart_table").on("click", ".td_remove", function(){
				var $counter = $('.notification-counter');
                var val = parseInt($counter.text());
                if ($counter.text() > 0) val--;
                return $counter.css({ opacity: 0 }).text(val).css({ top: '-10px' }).animate({ top: '-1px', opacity: 1 }, 500);
			}); */
			

			
			// Price sort dynamic arrow setup
            $(".price_sort").click(function () {
            	
                if ($("#sort_by_price").hasClass("fa-arrow-down"))
                	{
                	$("#sort_by_price").removeClass("fa fa-arrow-down", function(){
                		$("#sort_by_price").addClass("fa fa-arrow-up");
                	});
                	}
                    
                else{
	                	$("#sort_by_price").removeClass("fa fa-arrow-up", function(){
	                		$("#sort_by_price").addClass("fa fa-arrow-down");
	                	}); 	
                }
            });
            
            
            var timeout = setTimeout(getUpdates, 0);
            getUpdates();
            // Update the "items found" number
            function getUpdates() {
	            var n = $(".prod").length;
	            $(".items_found").text(n);
	            timeout = setTimeout(getUpdates, 50);
            }
            

            // Switch between grid & list views
            $('img').on('click', function (e) {
                if ($(this).hasClass('grid')) {
                    $('#prods ul').removeClass('list').addClass('grid');
                    $(this).attr('src', 'images/gridview_on.png')
                    $('img.list').attr('src', 'images/listview_off.png');
                }
                else if ($(this).hasClass('list')) {
                    $('#prods ul').removeClass('grid').addClass('list');
                    $(this).attr('src', 'images/listview_on.png')
                    $('img.grid').attr('src', 'images/gridview_off.png');
                }
            });

            // Tooltips
            $(".wishlist_icon").tooltip();

            $(function () {
                var wish_icon = $(".wishlist_icon");
                wish_icon.hover(function () {
                    if (wish_icon.hasClass("fa-heart")) {
                        wish_icon.attr('data-original-title', 'Remove from wishlist');
                    }
                    else { wish_icon.attr('data-original-title', 'Add to wishlist'); }
                });
            });

            // Wishlist icon on/off
            var wishlist = $('.wishlist_icon_1');
            wishlist.click(function () {
                if (wishlist.hasClass("fa-heart-o")) {
                    wishlist.switchClass("fa-heart-o", "fa-heart");

                }
                else {
                    wishlist.switchClass("fa-heart", "fa-heart-o");
                }
            });

            // Sticky #navbar
            var menu = document.querySelector('#navbar');
            var menuPosition = menu.getBoundingClientRect();
            var placeholder = document.createElement('div');
            placeholder.style.width = menuPosition.width + 'px';
            placeholder.style.height = menuPosition.height + 'px';

            var isAdded = false;

            window.addEventListener('scroll', function () {
                if (window.pageYOffset >= menuPosition.top && !isAdded) {
                    menu.classList.add('sticky');
                    menu.parentNode.insertBefore(placeholder, menu);
                    isAdded = true;
                } else if (window.pageYOffset < menuPosition.top && isAdded) {
                    menu.classList.remove('sticky');
                    menu.parentNode.removeChild(placeholder);
                    isAdded = false;
                }
            });
            



            $(".price_sort").click(function () {
                if ($("#sort_by_price").hasClass("fa-arrow-up"))
                    $("#sort_by_price").removeClass("fa-arrow-up").addClass("fa-arrow-down");
                else
                    $("#sort_by_price").removeClass("fa-arrow-down").addClass("fa-arrow-up");
            });


            $('#toggle').click(function () {
                if ($('.toggle').css('display') == 'none') {
                    $('#tog_img').attr('src', 'images/toggle_off.png');
                }
                else {
                    $('#tog_img').attr('src', 'images/toggle_on.png');
                }
                $('.toggle').toggle('slow')
                return false;
            });

            $('#toggle2').click(function () {
                if ($('.toggle2').css('display') == 'none') {
                    $('#tog_img').attr('src', 'images/toggle_off.png');
                }
                else {
                    $('#tog_img').attr('src', 'images/toggle_on.png');
                }
                $('.toggle2').toggle('slow')
                return false;
            });
            
            $('.check_id').trigger('click');
             
            
        });

        
     // Product description tabs setup
        $("#prod_desc").css("display", "block");
        
     	function openTab(evt, tabName) {
        	var i, x, tablinks;
                x = document.getElementsByClassName("prod_tabs");
                for (i = 0; i < x.length; i++) {
                    x[i].style.display = "none";
                }
                tablinks = document.getElementsByClassName("tablink");
                for (i = 0; i < x.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" selected_tab", "");
                }
                
                document.getElementById(tabName).style.display = "block";
                evt.currentTarget.className += " selected_tab";
        }
        
		    // Enlarge product image        
	        function maximize() {
	            $(".prod_img img").css("margin", "0");
	            $(".prod_img").css({ "overflow-x": "visible", "z-index": "999" });
	        }
	     
	        function minimize() {
	            $(".prod_img").css({ "overflow-x": "hidden", "z-index": "999" });
	            $(".prod_img img").css("margin", "0 -100%");
	        } 
        
            // Get the modals
            var login_modal = document.getElementById('login_modal');
            var signup_modal = document.getElementById('signup_modal');
            var prod_modal = document.getElementById('prod_modal');
            var cart_modal = document.getElementById('cart_modal');
            var about_modal = document.getElementById('about_modal');
            var contact_modal = document.getElementById('contact_modal');
            var admin_modal = document.getElementById('admin_modal');
            var error_modal = document.getElementById('error_modal');
            
            // Get the buttons that opens the modals
            var login_btn = document.getElementById("login");
            var signup_btn = document.getElementById("signup");
            var prod_over = document.getElementsByClassName("prod_overlay");
            var prod_det = document.getElementsByClassName("prod_details");
            var cart_btn = document.getElementById("cart");
            var admin_btn = document.getElementById("admin");

            // When the user clicks on the buttons, open the modals
            login_btn.onclick = function () {
                login_modal.style.display = "block";
            }
            signup_btn.onclick = function () {
                signup_modal.style.display = "block";
            }
            cart_btn.onclick = function () {
                cart_modal.style.display = "block";
            }
            admin_btn.onclick = function () {
            	admin_modal.style.display = "block";
            	 login_modal.style.display = "none";
            }

         	// Side nav > my account link
            $("#mySidenav > a:nth-of-type(2)").click(function(){
            	account_modal.style.display = "block";
            });
            // Side nav > my cart link
            $("#mySidenav > a:nth-of-type(3)").click(function(){
            	cart_modal.style.display = "block";
            });  
         	// Side nav > about link
            $("#mySidenav > a:nth-of-type(4)").click(function(){
            	about_modal.style.display = "block";
            });
         	// Side nav > contact link
            $("#mySidenav > a:nth-of-type(5)").click(function(){
            	contact_modal.style.display = "block";
            });
            
            $("#prods").on('click', prod_over, function(e) {
           		if (e.target.className == "prod_overlay") {
           			prod_modal.style.display = "block";
           		}
           		else if(e.target.className == "prod_overlay_title ng-binding") { 
           			prod_modal.style.display = "block";
           		}
           		else if(e.target.className == "prod_overlay_cat ng-binding") { 
           			prod_modal.style.display = "block";
           		}	
           		else {  		
           		}	
         	 });
            
            $("#PrintAllProducs").on('click', prod_det, function(e) {
           		if (e.target.className == "prod_details") {
           			prod_modal.style.display = "block";
           		}
           		else {  		
           		}	
         	 });

            
            $("#cart_modal .close").click(function(){
            	
            });
            
            // When the user clicks on (x), close the modals
            function close_modal() {
            	prod_modal.style.display = "none";
            	cart_modal.style.display = "none";
            	signup_modal.style.display = "none";
            	login_modal.style.display = "none";
            	login_msg.style.display = "none";  
            	signup_msg.style.display = "none";
            	about_modal.style.display = "none";
            	contact_modal.style.display = "none";
            	admin_modal.style.display = "none";
                error_modal.style.display = "none";
            }

            
            function goto_signup(){
            	login_modal.style.display = "none";
            	signup_modal.style.display = "block";
            }
             
            
            var login_msg = document.getElementById("login_msg");
			var signup_msg = document.getElementById("signup_msg");
            var error_msg = document.getElementById("error_msg");

		
            function show_signup_msg () {
                signup_msg.style.display = "block";   
            }
            
            function show_login_msg () {
                login_msg.style.display = "block";   
            }

            
            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function (event) {
                if (event.target == error_modal) {
                    error_modal.style.display = "none";
                } 
               if (event.target == login_modal) {
                    login_modal.style.display = "none";
                } 
                 if (event.target == signup_modal) {
                    signup_modal.style.display = "none";
                } 
                if (event.target == prod_modal) {
                    prod_modal.style.display = "none";
                }
                if (event.target == cart_modal) {
                    cart_modal.style.display = "none";
                    $("#empty_msg").remove();
                }
                if (event.target == about_modal) {
                	about_modal.style.display = "none";
                }
                if (event.target == about_modal) {
                	contact_modal.style.display = "none";
                }
                if (event.target == admin_modal) {
                	admin_modal.style.display = "none";
                }
            }

            
            
            // Bootstrap plugin minus and plus
            $('.btn-number').click(function (e) {
                e.preventDefault();

                fieldName = $(this).attr('data-field');
                type = $(this).attr('data-type');
                var input = $("input[name='" + fieldName + "']");
                var currentVal = parseInt(input.val());
                if (!isNaN(currentVal)) {
                    if (type == 'minus') {

                        if (currentVal > input.attr('min')) {
                            input.val(currentVal - 1).change();
                        }
                        if (parseInt(input.val()) == input.attr('min')) {
                            $(this).attr('disabled', true);
                        }

                    } else if (type == 'plus') {

                        if (currentVal < input.attr('max')) {
                            input.val(currentVal + 1).change();
                        }
                        if (parseInt(input.val()) == input.attr('max')) {
                            $(this).attr('disabled', true);
                        }

                    }
                } else {
                    input.val(0);
                }
            });
            $('.input-number').focusin(function () {
                $(this).data('oldValue', $(this).val());
            });
            $('.input-number').change(function () {

                minValue = parseInt($(this).attr('min'));
                maxValue = parseInt($(this).attr('max'));
                valueCurrent = parseInt($(this).val());

                name = $(this).attr('name');
                if (valueCurrent >= minValue) {
                    $(".btn-number[data-type='minus'][data-field='" + name + "']").removeAttr('disabled')
                } else {
                    alert('Sorry, the minimum value was reached');
                    $(this).val($(this).data('oldValue'));
                }
                if (valueCurrent <= maxValue) {
                    $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
                } else {
                    alert('Sorry, the maximum value was reached');
                    $(this).val($(this).data('oldValue'));
                }
            });
            $(".input-number").keydown(function (e) {
                // Allow: backspace, delete, tab, escape, enter and .
                if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
                    // Allow: Ctrl+A
                    (e.keyCode == 65 && e.ctrlKey === true) ||
                    // Allow: home, end, left, right
                    (e.keyCode >= 35 && e.keyCode <= 39)) {
                    // let it happen, don't do anything
                    return;
                }
                // Ensure that it is a number and stop the keypress
                if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                    e.preventDefault();
                }
            });

        // Set the width of the side navigation to 250px
        function openNav() {
            document.getElementById("mySidenav").style.left = "0";
            document.getElementById("main").style.visibility = "visible";
            document.getElementById("main").style.opacity = "1";
        }

        // Set the width of the side navigation to 0
        function closeNav() {
            document.getElementById("mySidenav").style.left = "-250px";
        }

        // Back to top arrow
        $(window).scroll(function () {
            if ($(this).scrollTop() >= 1200) {        // If page is scrolled more than 1000px
                $('#return-to-top').fadeIn(200);    // Fade in the arrow
            } else {
                $('#return-to-top').fadeOut(200);   // Else fade out the arrow
            }

            $("#banner").css("opacity", 1 - $(window).scrollTop() / 600);
            $("#browse_stuff").css("opacity", 1 - $(window).scrollTop() / 800);

        });
        $('#return-to-top').click(function () {      // When arrow is clicked
            $('body,html').animate({
                scrollTop: $('#options_bar').offset().top - 70     // Scroll to top of #options_bar
            }, 500);
        });
    </script>

    <script type="text/javascript">
        $(function () {
            $('a[href*="#"]:not([href="#"])').click(function () {
                if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
                    var target = $(this.hash);
                    target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                    if (target.length) {
                        $('html, body').animate({
                            scrollTop: target.offset().top
                        }, 1000);
                        return false;
                    }
                }
            });
        });
    </script>
    
    <script type="text/javascript">
    var nonLinearSlider = document.getElementById('price_slider');

    noUiSlider.create(nonLinearSlider, {
        connect: true,
        behaviour: 'tap',
        start: [0, 800],
        tooltips: true,
        //format: wNumb({
        //    decimals: 0
        //}),
        range: {
            // Starting at 500, step the value by 500,
            // until 4000 is reached. From there, step by 1000.
            'min': [0, 5],
            '10%': [50, 10],
            '50%': [400, 50],
            'max': [800]
        }
    });
    
     
   	var nodes = [
             	document.getElementById('value-lower'), // 0
             	document.getElementById('value-upper') // 1
             ];

	nonLinearSlider.noUiSlider.on('update', function( values, handle ) {
		nodes[handle].innerHTML = values[handle];
		min_price = $("#value-lower").html();
		max_price = $("#value-upper").html();
	});
	
    </script>
    
    <script type="text/javascript">
    var MyStuffCustomerApp = angular.module("MyStuffCustomerApp", []);

    MyStuffCustomerApp.controller("CustomerController", function($scope, $window, $http, $rootScope, $location ,$timeout){
    	
        /* Local Variables */
        $scope.authKeyName = "mystuffAuth"
        $scope.cartKeyName = "mystuffCart"
    	$scope.baseUrl = $location.protocol() + '://'+ $location.host() +':'+  $location.port()+"/mystuff/rest/customer";
		$scope.isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    	$scope.reverse = true ; 
		$scope.bool = true ;
		$scope.logoutBtnKey = true;
		$scope.loginBtnKey = true;
		$scope.signupBtnKey = true;
		$scope.myAccountKey = true;
        $scope.PrintAllProducts = [] ;
        $scope.cartSize =  0 ;

       /* Buttons Handlers */
        $scope.myAccountShow = function () {
		    return $scope.myAccountKey ;
		};
		
		$scope.logoutBtnShow = function () {
		    return $scope.logoutBtnKey ;
		}; 
		
		$scope.loginBtnShow = function () {
		    return $scope.loginBtnKey ;
		}; 
		$scope.signupBtnShow = function () {
		    return $scope.signupBtnKey ;
		}; 

        /* Login/Signup/logout API*/
	 	$scope.login = function(event){
		var email = $scope.email ;
		var password = $scope.password ; 
	 	var credentials = {email , password} ;
		$http({
	        method : "POST",
	        url : $scope.baseUrl +"/login/",
	        data : credentials,
	        headers: {
	        	'Content-Type': 'application/json',
	        	'Accept': 'application/json',
	        	},
	    })
        .then(function mySuccess(response) {
	    	$scope.loginResponse =  response.data;
			if ($scope.loginResponse.succesfullOpt==true){
                    $scope.saveUserInfoInStorage(credentials) ;
                    $scope.getCart();
                    if(event && event.srcElement.attributes["data-admin"]) {
                        $scope.handleCustomerSession('adminLogin');
                        return ;
                    }
					$scope.handleCustomerSession('login');
                    return ;
			}
		
			$scope.loginMessage = $scope.loginResponse.message ;
	    }, function myError(response) {
            $scope.loginResponse =  response.data;
            $scope.loginMessage = $scope.loginResponse.message ;
	    });
	 	}

        //Logout is done by removing user info from Local Storage
        $scope.logout = function(){
            $scope.handleCustomerSession('logout');
        } 
		

	 	$scope.signUp = function(){
            $scope.showOrHideLoader(true);
	 		var firstName = $scope.name;
	 		var surName = $scope.f_name ;
			var password = $scope.password ; 
			var secondPassword = $scope.secondPassword ; 
			var email = $scope.email ;
		 	var credentials = {firstName,surName,password,secondPassword,email} ;
		 	
			$http({
		        method : "POST",
		        url : $scope.baseUrl +"/signUp/",
		        data : credentials,
		        headers: {
		        	'Content-Type': 'application/json',
		        	'Accept': 'application/json',
		        	},
		    })
            .then(function mySuccess(response) {
	    	$scope.loginResponse =  response.data;
			if ($scope.loginResponse.succesfullOpt==true){
                    $scope.saveUserInfoInStorage(credentials) ;
					$scope.handleCustomerSession("signUp");
                    $scope.showOrHideLoader(false);
                    return ;
			}
		
			$scope.signupMessage = $scope.loginResponse.additionalInfo ;
            }, function myError(response) {
                $scope.signupMessage =  response.data;
                $scope.signupMessage = $scope.signupMessage.additionalInfo ;
                $scope.showOrHideLoader(false);
            });
	 	}
	 	
		    
		
        /*  Products API*/
       	$scope.getAllProducts = function(){
       		$scope.showOrHideLoader(true);
    		url = $scope.baseUrl+"/getAllProducts" ; 
    		$http.get(url).then(
    				function(response){
    					$scope.PrintAllProducts = response.data ;
                        $scope.showOrHideLoader(false); 
    				}, function(response){
    					$scope.errormessage = response.data.message;
                        $scope.showOrHideLoader(false); 
    				});
    	}

     	$scope.getProductByName = function(){
            $scope.showOrHideLoader(true);
    		url = $scope.baseUrl + "/getProductByName/"+ $scope.name;
    		console.log(url);
    		$http.get(url).then(
    				function(response){
    					$scope.infomessage = response.data.message;
                        $scope.showOrHideLoader(false);
    				}, function(response){
    					$scope.infomessage = response.data.message;
                        $scope.showOrHideLoader(false);
    				});
    	} 
    	
    	$scope.getProductById = function(prodId){
    		$scope.showOrHideLoader(true);
            $scope.PrintAllProductsById = null ;
    		url = $scope.baseUrl + "/getProductById/"+ prodId;
    		$http.get(url).then(
    				function(response){
    					$scope.showOrHideLoader(false);
                        $scope.PrintAllProductsById = [response.data] ;
    				}, function(response){
                        $scope.showOrHideLoader(false);
    					$scope.infomessage = response.data.message;
    				});
    	}

    	$scope.getAllProductByPriceEx = function(){
    		$scope.showOrHideLoader(true);
    		url = $scope.baseUrl + "/getAllProductByPriceEx/";
    		console.log(url);
    		$http.get(url).then(
    				function(response){
    					$scope.showOrHideLoader(false);
    						$scope.PrintAllProducts = $scope.PrintAllProductByPriceEx; 
        					$scope.PrintAllProducts = response.data ;

    				}, function(response){
                        $scope.showOrHideLoader(false);
    					$scope.infomessage = response.data.message;
    				});
    	}
    	
    	$scope.getAllProductByPriceChe = function(){
    		$scope.showOrHideLoader(true);
    		url = $scope.baseUrl + "/getAllProductByPriceChe/";
    		$http.get(url).then(
    				function(response){
    					$scope.showOrHideLoader(false);
    					if ($scope.bool==true){
    						$scope.getAllProductByPriceEx();
    						$scope.PrintAllProducts = $scope.PrintAllProductByPriceEx;
    						$scope.bool = false;
    					}
    					else{
    						$scope.PrintAllProducts = $scope.PrintAllProductByPriceChe; 
        					$scope.PrintAllProducts = response.data ;
        					$scope.bool = true;
    					}
    					
    				}, function(response){
                        $scope.showOrHideLoader(false);
    					$scope.infomessage = response.data.message;
    				});
    	}
    	
    	$scope.getAllProductsByType = function(){
    		$scope.PrintAllProducts = [] ;
    		$scope.showOrHideLoader(true);
    		url = $scope.baseUrl + "/getAllProductsByType/"+$scope.Type;
    		$http.get(url).then(
    				function(response){
    					$scope.showOrHideLoader(false);
    					if($scope.Type!=false) {
    					$scope.PrintAllProducts = $scope.PrintAllProductsByType;
    					$scope.PrintAllProducts = response.data;
    					}
    					else {
    						$scope.getAllProducts();
    						$scope.PrintAllProducts = response.data;
    					}
    				}, function(response){
                        $scope.showOrHideLoader(false);
    				});
    	}

        $scope.searchProductByPrice = function(){
    		$scope.showOrHideLoader(true);
    		var min_price = document.getElementById( "value-lower" ).innerText ;
    	    var  max_price = document.getElementById( "value-upper" ).innerText ; 
    		url = $scope.baseUrl + "/searchProductByPrice/" + min_price + "/" + max_price ;
    		$http.get(url).then(
    				function(response){	
    					$scope.showOrHideLoader(false);
    					$scope.PrintAllProducts = $scope.PrintAllsearchesByPriceRange; 
    					$scope.PrintAllProducts = response.data ;

    				}, function(response){
                        $scope.showOrHideLoader(false);
    					$scope.getAllProducts();
						$scope.PrintAllProducts = response.data;
    				});
    	}

    	
        /* Cart (wishlist) API*/

        $scope.addToCart = function(prodIdNum ){
            $scope.showOrHideLoader(true);
            var userCredentials = $scope.getUserInfoFromStorage() ;
			$http({
		        method : "POST",
		        url : $scope.baseUrl + "/addToCart/" + prodIdNum ,
		        headers: {
		        	'Content-Type': 'application/json',
		        	'Accept': 'application/json',
                    'Authorization' : 'Basic ' + userCredentials.basic
		        	},
		    })
            .then(function mySuccess(response) {
	    	$scope.addToCartResponse =  response.data;
			if ($scope.addToCartResponse.succesfullOpt==true){
                $scope.cart = $scope.addToCartResponse.modelDtoObject ;
                $scope.saveUserCartInStorage($scope.cart) ;
                $scope.cartSize =  $scope.cart.size ;
                $scope.cartSum = $scope.cart.sum ;
                $scope.PrintCart = $scope.cart.wishlistProducts ;
                $scope.showOrHideLoader(false);
                return ;
			}
		
			$scope.globalErrorMessage = $scope.addToCartResponse.additionalInfo ;
            }, function myError(response) {
                $scope.addToCartResponse =  response.data;
                $rootScope.globalErrorMessage = $scope.addToCartResponse.additionalInfo ;
                $scope.showOrHideErrorMessage(true) ;
                $scope.showOrHideLoader(false);
            });
	 	}

    	
        $scope.getCart = function(prodIdNum ){
            $scope.showOrHideLoader(true);
            var userCredentials = $scope.getUserInfoFromStorage() ;
			$http({
		        method : "POST",
		        url : $scope.baseUrl + "/getCart",
		        headers: {
		        	'Content-Type': 'application/json',
		        	'Accept': 'application/json',
                    'Authorization' : 'Basic ' + userCredentials.basic
		        	},
		    })
            .then(function mySuccess(response) {
	    	$scope.getCartResponse =  response.data;
			if ($scope.getCartResponse.succesfullOpt==true){
                $scope.cart = $scope.getCartResponse.modelDtoObject ;
                $scope.saveUserCartInStorage($scope.cart) ;
                $scope.cartSize =  $scope.cart.size ;
                $scope.cartSum = $scope.cart.sum ;
                $scope.PrintCart = $scope.cart.wishlistProducts ;
                $scope.showOrHideLoader(false);
                return ;
			}
		
			$scope.globalErrorMessage = $scope.getCartResponse.additionalInfo ;
            }, function myError(response) {
                $scope.getCartResponse =  response.data;
                $scope.globalErrorMessage = $scope.getCartResponse.additionalInfo ;
                $scope.showOrHideErrorMessage(true) ;
                $scope.showOrHideLoader(false);
            });
	 	}

         $scope.removeFromCart = function(prodIdNum){
            $scope.showOrHideLoader(true);
            var userCredentials = $scope.getUserInfoFromStorage() ;
			$http({
		        method : "POST",
		        url : $scope.baseUrl + "/removeFromCart/" + prodIdNum,
		        headers: {
		        	'Content-Type': 'application/json',
		        	'Accept': 'application/json',
                    'Authorization' : 'Basic ' + userCredentials.basic
		        	},
		    })
            .then(function mySuccess(response) {
	    	$scope.getCartResponse =  response.data;
			if ($scope.getCartResponse.succesfullOpt==true){
                $scope.cart = $scope.getCartResponse.modelDtoObject ;
                $scope.saveUserCartInStorage($scope.cart) ;
                $scope.cartSize =  $scope.cart.size ;
                $scope.cartSum = $scope.cart.sum ;
                $scope.PrintCart = $scope.cart.wishlistProducts ;
                $scope.showOrHideLoader(false);
                return ;
			}
		
			$scope.globalErrorMessage = $scope.getCartResponse.additionalInfo ;
            }, function myError(response) {
                $scope.getCartResponse =  response.data;
                $scope.globalErrorMessage = $scope.getCartResponse.additionalInfo ;
                $scope.showOrHideErrorMessage(true) ;
                $scope.showOrHideLoader(false);
            });
	 	}

        /* Orders API */
    	
        $scope.checkOut = function(){
            $scope.showOrHideLoader(true);
            var userCredentials = $scope.getUserInfoFromStorage() ;
			$http({
		        method : "POST",
		        url : $scope.baseUrl + "/checkOut"  ,
		        headers: {
		        	'Content-Type': 'application/json',
		        	'Accept': 'application/json',
                    'Authorization' : 'Basic ' + userCredentials.basic
		        	},
		    })
            .then(function mySuccess(response) {
	    	$scope.newOrderResponse =  response.data;
			if ($scope.newOrderResponse.succesfullOpt==true){
                $scope.clearCart() ;
                $scope.order = $scope.newOrderResponse.modelDtoObject ;
                $scope.orderId = $scope.order.orderId ; 
                $scope.cartMessage = $scope.newOrderResponse.message ;
                $scope.showOrHideLoader(false);
                return ;
			}
		
			$scope.globalErrorMessage = $scope.newOrderResponse.additionalInfo ;
            }, function myError(response) {
                $scope.newOrderResponse =  response.data;
                $rootScope.globalErrorMessage = $scope.newOrderResponse.additionalInfo ;
                $scope.showOrHideErrorMessage(true) ;
                $scope.showOrHideLoader(false);
            });
	 	}
    		
    		

        /* Helper methods */

        //In user logged in - show welcome message
        $scope.handleCustomerSession = function(action){
            var userInfo = $scope.getUserInfoFromStorage() ;
            var userCart = $scope.getUserCartFromStorage() ;
            var userCerString =  JSON.stringify(userCart) ;
            switch (action) {
                case 'adminLogin':
                    jQuery('#welcome_msg').empty();
                    jQuery('#admin_modal .modal_content')
                    .slideUp(function(){
                        jQuery('#admin_modal').hide();
                        jQuery('#header').prepend('<div id="welcome_msg"><span style="color:#e0452b;'+ 
                                'font-weight:normal;">Welcome, </span>' + userInfo.email + '</div>');
                    });	
                    $scope.logoutBtnKey = true;
                    $scope.loginBtnKey = false;
                    $scope.signupBtnKey = false;
                    $scope.myAccountKey = true;
                    $timeout(function () {
					    	$window.location.href ='admin.html';	
					    }, 0);
                break;

                case 'login':
                    jQuery('#welcome_msg').empty();
                    jQuery('#login_modal .modal_content')
                    .slideUp(function(){
                        jQuery('#login_modal').hide();
                        jQuery('#header').prepend('<div id="welcome_msg"><span style="color:#e0452b;'+ 
                                'font-weight:normal;">Welcome, </span>' + userInfo.email + '</div>');
                    });	
                    $scope.logoutBtnKey = true;
                    $scope.loginBtnKey = false;
                    $scope.signupBtnKey = false;
                    $scope.myAccountKey = true;

                    if(userCerString.lenght != 0 && userCerString != '{}'){
                        $scope.cartSize = userCart.size ;
                        $scope.cartSum = userCart.sum ;
                    }
                    break;

                case 'signUp':
                    jQuery('#welcome_msg').empty();
                    jQuery('#signup_modal .modal_content')
                    .slideUp(function(){
                            jQuery('#signup_modal').hide();
                            jQuery('#header').prepend('<div id="welcome_msg"><span style="color:#e0452b;'+ 
                                'font-weight:normal;">Welcome, </span>' + userInfo.email + '</div>');
                    }); 
                    $scope.logoutBtnKey = true;
                    $scope.loginBtnKey = false;
                    $scope.signupBtnKey = false;
                    $scope.myAccountKey = true;
                    break;

                case 'refresh':
                    var userInfo = $scope.getUserInfoFromStorage() ;
                    var userInfoString =  JSON.stringify(userInfo) ;
                    if(userInfoString.lenght != 0 && userInfoString != '{}'){
                        setTimeout(function(){
                            jQuery('#header').prepend('<div id="welcome_msg"><span style="color:#e0452b;'+ 
                                    'font-weight:normal;">Welcome, </span>' + userInfo.email + '</div>');           
                        }, 0);
                        $scope.logoutBtnKey = true;
                        $scope.loginBtnKey = false;
                        $scope.signupBtnKey = false;
                        $scope.myAccountKey = true;
                    }
                    
                    else {
                        $scope.logoutBtnKey = false;
                        $scope.loginBtnKey = true;
                        $scope.signupBtnKey = true;
                        $scope.myAccountKey = false
                    }

                    if(userCerString.lenght != 0 && userCerString != '{}'){
                        $scope.cartSize = userCart.size ;
                        $scope.cartSum = userCart.sum ;
                    }
                    break;

                case 'logout':
                    jQuery('#welcome_msg').empty();
                    $scope.logoutBtnKey = false;
                    $scope.loginBtnKey = true;
                    $scope.signupBtnKey = true;
                    $scope.myAccountKey = false
                    $window.localStorage.removeItem($scope.authKeyName) ;
                    $scope.clearCart() ;
                    $scope.cleanUpVariables() ;
                    jQuery('#signup_modal .modal_content').show() ;
                    jQuery('#login_modal .modal_content').show() ;
                    break;

                case 'myAccount':
                var userInfo = $scope.getUserInfoFromStorage() ;
                    var userInfoString =  JSON.stringify(userInfo) ;
                    if(userInfoString.lenght != 0 && userInfoString != '{}'){
                        $window.location.href = 'my-account.html';
                    }
                    else {
                        $rootScope.globalErrorMessage = "Please login first!" ;
                        $scope.showOrHideErrorMessage(true) ;
                    }
                    break;

                default:
                    console.error(`action, was not found ${action}.`);
                }
    	}


        //Get User indo from Local Storage
        $scope.getUserInfoFromStorage = function(){
            $scope.localStorageInfo =  $window.localStorage.getItem($scope.authKeyName) ;
            if($scope.localStorageInfo){
                return JSON.parse($scope.localStorageInfo) ;
            }
            return {} ;
        }

        //Handle post login operations
        $scope.saveUserInfoInStorage = function(credentials){
            credentials.basic = btoa(credentials.email+':'+credentials.password) ;
            $scope.userInfo = JSON.stringify(credentials) ;
            $window.localStorage.setItem($scope.authKeyName, $scope.userInfo) ;
        }

        //Get cart info from local storage
        $scope.getUserCartFromStorage = function(){
            $scope.localStorageCart =  $window.localStorage.getItem($scope.cartKeyName) ;
            if($scope.localStorageCart){
                return JSON.parse($scope.localStorageCart) ;
            }
            return {} ;
        }

        //save cart info in local storage
        $scope.saveUserCartInStorage = function(cart){
            $scope.userCart = JSON.stringify(cart) ;
            $window.localStorage.setItem($scope.cartKeyName, $scope.userCart) ;
        }

        
		$scope.cleanUpVariables = function(){
			$scope.email = "";
	    	$scope.password = "";
	    	$scope.name ="";
	    	$scope.f_name ="";
	    	$scope.secondPassword ="";
	    	$scope.adminLoginMessage ="" ;
	    	$scope.loginMessage ="" ;
	    	$scope.signupMessage ="" ;
		}

        $scope.clearCart = function(){
            $window.localStorage.removeItem($scope.cartKeyName) ;
            $scope.cartSize =  0 ;
            $scope.cartSum = 0 ;
            $scope.PrintCart = [] ;
        }
		
		$scope.showOrHideLoader = function(show){
            if(show){
                jQuery('.lds-grid').show();
                return ;
            }
            jQuery('.lds-grid').hide();
		}

        $scope.showOrHideErrorMessage= function(show) {
            if(show){
                jQuery('#error_modal').show();
                return ;
            }
        }

    });

    </script>
</body>
</html>
